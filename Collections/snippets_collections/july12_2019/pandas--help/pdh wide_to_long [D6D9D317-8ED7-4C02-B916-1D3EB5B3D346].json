{
  "alfredsnippet" : {
    "snippet" : "df = pd.DataFrame({\"A1970\" : list('ab'),\"A1980\" : list('de'),\"B1970\" : [2,3],\n                   \"B1980\" : [10,20],\"price\" : [100,200],\"id\" : [1,4]})\n\n## make it long\npd.wide_to_long(df, ['A', 'B'], i=['price','id'] , j='year').reset_index()\n\n   price  id  year  A   B\n0    100   1  1970  a   2\n1    100   1  1980  d  10\n2    200   4  1970  b   3\n3    200   4  1980  e  20\n\n## example 2 *********************\nData:\nyear           artist          track  time date.entered  wk1  wk2\n2000           Pac             Baby   4:22   2000-02-26   87   82\n2000           Adele           Hello    3:15   2000-09-02  91   87\n\n# solution:\n# wk1 wk2 means week is 1 and week 2 and they have different ranks for the given song.\ndf = pd.read_clipboard()\ndf = pd.DataFrame({'year' : [2000, 2000],\n          'artist' : ['Justin', 'Adele'],\n          'track' : ['Baby', 'Hello'],\n          'time' : ['4:22', '3:15'],\n          'date.entered' : ['2000-02-26', '2000-09-02'],\n          'wk1' : [87, 91],\n          'wk2' : [82, 87]})\n\n# reorder columns and make wk1 wk2 end columns\ndf = df[['year', 'artist', 'date.entered', 'time', 'track', 'wk1', 'wk2']]\ndf1 = (pd.wide_to_long(df, 'wk', i=df.columns.values[:5], j='week')\n         .reset_index()\n         .rename(columns={'date.entered': 'date', 'wk': 'rank'})\n         .assign(date = lambda x: pd.to_datetime(x['date']) + \n                                  pd.to_timedelta((x['week'].astype(int) - 1) * 7, 'd'))\n         .sort_values(by=['track', 'date'])\n)\nprint(df1)\n   year  artist       date  time  track week  rank\n0  2000  Justin 2000-02-26  4:22   Baby    1    87\n1  2000  Justin 2000-03-04  4:22   Baby    2    82\n2  2000   Adele 2000-09-02  3:15  Hello    1    91\n3  2000   Adele 2000-09-09  3:15  Hello    2    87",
    "uid" : "D6D9D317-8ED7-4C02-B916-1D3EB5B3D346",
    "name" : "pdh wide_to_long",
    "keyword" : "pdh-wide_to_long"
  }
}